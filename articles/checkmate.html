<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkmate • checkmate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Checkmate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">checkmate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/checkmate.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tinytest.html">Setup tinytest</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mllg/checkmate/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Checkmate</h1>
                        <h4 data-toc-skip class="author">Michel
Lang</h4>
            
            <h4 data-toc-skip class="date">2024-07-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mllg/checkmate/blob/master/vignettes/checkmate.Rmd" class="external-link"><code>vignettes/checkmate.Rmd</code></a></small>
      <div class="hidden name"><code>checkmate.Rmd</code></div>

    </div>

    
    
<p>Ever used an R function that produced a not-very-helpful error
message, just to discover after minutes of debugging that you simply
passed a wrong argument?</p>
<p>Blaming the laziness of the package author for not doing such
standard checks (in a dynamically typed language such as R) is at least
partially unfair, as R makes these types of checks cumbersome and
annoying. Well, that’s how it was in the past.</p>
<p>Enter checkmate.</p>
<p>Virtually <strong>every standard type of user error</strong> when
passing arguments into function can be caught with a simple, readable
line which produces an <strong>informative error message</strong> in
case. A substantial part of the package was written in C to
<strong>minimize any worries about execution time overhead</strong>.</p>
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>As a motivational example, consider you have a function to calculate
the faculty of a natural number and the user may choose between using
either the stirling approximation or R’s <code>factorial</code> function
(which internally uses the gamma function). Thus, you have two
arguments, <code>n</code> and <code>method</code>. Argument
<code>n</code> must obviously be a positive natural number and
<code>method</code> must be either <code>"stirling"</code> or
<code>"factorial"</code>. Here is a version of all the hoops you need to
jump through to ensure that these simple requirements are met:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">method</span> <span class="op">=</span> <span class="st">"stirling"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' must have length 1"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' must be numeric"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' may not be NA"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">is.double</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' may not be NaN"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' must be finite"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' must be an integerish value"</span><span class="op">)</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'n' must be &gt;= 0"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'method' must have length 1"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="va">method</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stirling"</span>, <span class="st">"factorial"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Argument 'method' must be either 'stirling' or 'factorial'"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"factorial"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="kw">else</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="va">n</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>And for comparison, here is the same function using checkmate:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">method</span> <span class="op">=</span> <span class="st">"stirling"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/checkCount.html">assertCount</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/checkChoice.html">assertChoice</a></span><span class="op">(</span><span class="va">method</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stirling"</span>, <span class="st">"factorial"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"factorial"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="kw">else</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="va">n</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-overview">Function overview<a class="anchor" aria-label="anchor" href="#function-overview"></a>
</h2>
<p>The functions can be split into four functional groups, indicated by
their prefix.</p>
<p>If prefixed with <code>assert</code>, an error is thrown if the
corresponding check fails. Otherwise, the checked object is returned
invisibly. There are many different coding styles out there in the wild,
but most R programmers stick to either <code>camelBack</code> or
<code>underscore_case</code>. Therefore, <code>checkmate</code> offers
all functions in both flavors: <code>assert_count</code> is just an
alias for <code>assertCount</code> but allows you to retain your
favorite style.</p>
<p>The family of functions prefixed with <code>test</code> always return
the check result as logical value. Again, you can use
<code>test_count</code> and <code>testCount</code> interchangeably.</p>
<p>Functions starting with <code>check</code> return the error message
as a string (or <code>TRUE</code> otherwise) and can be used if you need
more control and, e.g., want to grep on the returned error message.</p>
<p><code>expect</code> is the last family of functions and is intended
to be used with the <a href="https://cran.r-project.org/package=testthat" class="external-link">testthat package</a>.
All performed checks are logged into the <code>testthat</code> reporter.
Because <code>testthat</code> uses the <code>underscore_case</code>, the
extension functions only come in the underscore style.</p>
<p>All functions are categorized into objects to check on the <a href="https://mllg.github.io/checkmate/reference/checkmate-package">package
help page</a>.</p>
</div>
<div class="section level2">
<h2 id="in-case-you-miss-flexibility">In case you miss flexibility<a class="anchor" aria-label="anchor" href="#in-case-you-miss-flexibility"></a>
</h2>
<p>You can use <a href="https://mllg.github.io/checkmate/reference/assert">assert</a> to
perform multiple checks at once and throw an assertion if all checks
fail.</p>
<p>Here is an example where we check that x is either of class
<code>foo</code> or class <code>bar</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/assert.html">assert</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/checkClass.html">checkClass</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"foo"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/checkClass.html">checkClass</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"bar"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that <code>assert(, combine = "or")</code> and
<code>assert(, combine = "and")</code> allow to control the logical
combination of the specified checks, and that the former is the
default.</p>
</div>
<div class="section level2">
<h2 id="argument-checks-for-the-lazy">Argument Checks for the Lazy<a class="anchor" aria-label="anchor" href="#argument-checks-for-the-lazy"></a>
</h2>
<p>The following functions allow a special syntax to define argument
checks using a special format specification. E.g.,
<code>qassert(x, "I+")</code> asserts that <code>x</code> is an integer
vector with at least one element and no missing values. This very simple
domain specific language covers a large variety of frequent argument
checks with only a few keystrokes. You choose what you like best.</p>
<ul>
<li><a href="https://mllg.github.io/checkmate/reference/qassert">qassert</a></li>
<li><a href="https://mllg.github.io/checkmate/reference/qassertr">qassertr</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="checkmate-as-testthat-extension">checkmate as testthat extension<a class="anchor" aria-label="anchor" href="#checkmate-as-testthat-extension"></a>
</h2>
<p>To extend <a href="https://cran.r-project.org/package=testthat" class="external-link">testthat</a>, you
need to IMPORT, DEPEND or SUGGEST on the <code>checkmate</code> package.
Here is a minimal example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># file: tests/test-all.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mllg.github.io/checkmate/">checkmate</a></span><span class="op">)</span> <span class="co"># for testthat extensions</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_package.html" class="external-link">test_check</a></span><span class="op">(</span><span class="st">"mypkg"</span><span class="op">)</span></span></code></pre></div>
<p>Now you are all set and can use more than 30 new expectations in your
tests.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"checkmate is a sweet extension for testthat"</span>, <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/checkNumeric.html">expect_numeric</a></span><span class="op">(</span><span class="va">x</span>, len <span class="op">=</span> <span class="fl">100</span>, any.missing <span class="op">=</span> <span class="cn">FALSE</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co"># or, equivalent, using the lazy style:</span></span>
<span>  <span class="fu"><a href="../reference/qassert.html">qexpect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"N100[0,1]"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="speed-considerations">Speed considerations<a class="anchor" aria-label="anchor" href="#speed-considerations"></a>
</h2>
<p>In comparison with tediously writing the checks yourself in R (c.f.
factorial example at the beginning of the vignette), R is sometimes a
tad faster while performing checks on scalars. This seems odd at first,
because checkmate is mostly written in C and should be comparably fast.
Yet many of the functions in the <code>base</code> package are not
regular functions, but primitives. While primitives jump directly into
the C code, checkmate has to use the considerably slower
<code>.Call</code> interface. As a result, it is possible to write (very
simple) checks using only the base functions which, under some
circumstances, slightly outperform checkmate. However, if you go one
step further and wrap the custom check into a function to convenient
re-use it, the performance gain is often lost (see benchmark 1).</p>
<p>For larger objects the tide has turned because checkmate avoids many
unnecessary intermediate variables. Also note that the quick/lazy
implementation in
<code>qassert</code>/<code>qtest</code>/<code>qexpect</code> is often a
tad faster because only two arguments have to be evaluated (the object
and the rule) to determine the set of checks to perform.</p>
<p>Below you find some (probably unrepresentative) benchmark. But also
note that this one here has been executed from inside <code>knitr</code>
which is often the cause for outliers in the measured execution time.
Better run the benchmark yourself to get unbiased results.</p>
<div class="section level3">
<h3 id="benchmark-1-assert-that-x-is-a-flag">Benchmark 1: Assert that <code>x</code> is a flag<a class="anchor" aria-label="anchor" href="#benchmark-1-assert-that-x-is-a-flag"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mllg.github.io/checkmate/">checkmate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">na.ok</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">na.ok</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/checkFlag.html">assertFlag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">cmq</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/qassert.html">qassert</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"B1"</span><span class="op">)</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">cmq</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##    expr   min     lq     mean median    uq      max neval</span></span>
<span><span class="co">##    r(x) 3.416 3.6215 26.07446 3.7315 3.822 2224.107   100</span></span>
<span><span class="co">##   cm(x) 2.334 2.4600 11.91587 2.5745 2.705  844.635   100</span></span>
<span><span class="co">##  cmq(x) 1.653 1.7730  9.01410 1.8485 1.934  685.438   100</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="benchmark-2-assert-that-x-is-a-numeric-of-length-1000-with-no-missing-nor-nan-values">Benchmark 2: Assert that <code>x</code> is a numeric of length 1000
with no missing nor NaN values<a class="anchor" aria-label="anchor" href="#benchmark-2-assert-that-x-is-a-numeric-of-length-1000-with-no-missing-nor-nan-values"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/checkNumeric.html">assertNumeric</a></span><span class="op">(</span><span class="va">x</span>, len <span class="op">=</span> <span class="fl">1000</span>, any.missing <span class="op">=</span> <span class="cn">FALSE</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cmq</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/qassert.html">qassert</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"N1000[0,1]"</span><span class="op">)</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">cmq</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##    expr    min     lq     mean  median     uq      max neval</span></span>
<span><span class="co">##    r(x) 12.674 13.320 56.42157 13.8660 18.870 4008.443   100</span></span>
<span><span class="co">##   cm(x)  5.360  5.706 17.32684  5.9555  6.938  987.251   100</span></span>
<span><span class="co">##  cmq(x)  6.913  7.124 18.08763  7.3790  9.623  954.660   100</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="benchmark-3-assert-that-x-is-a-character-vector-with-no-missing-values-nor-empty-strings">Benchmark 3: Assert that <code>x</code> is a character vector with
no missing values nor empty strings<a class="anchor" aria-label="anchor" href="#benchmark-3-assert-that-x-is-a-character-vector-with-no-missing-values-nor-empty-strings"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/checkCharacter.html">assertCharacter</a></span><span class="op">(</span><span class="va">x</span>, any.missing <span class="op">=</span> <span class="cn">FALSE</span>, min.chars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cmq</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/qassert.html">qassert</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"S+[1,]"</span><span class="op">)</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">cmq</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##    expr     min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">##    r(x) 277.477 278.1085 308.5654 278.6445 281.2995 2757.551   100</span></span>
<span><span class="co">##   cm(x) 289.300 290.0160 303.7077 291.0025 291.9695 1051.230   100</span></span>
<span><span class="co">##  cmq(x) 125.223 125.4630 135.6363 125.7990 126.3660  982.852   100</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="benchmark-4-test-that-x-is-a-data-frame-with-no-missing-values">Benchmark 4: Test that <code>x</code> is a data frame with no
missing values<a class="anchor" aria-label="anchor" href="#benchmark-4-test-that-x-is-a-data-frame-with-no-missing-values"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">is.data.frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/checkDataFrame.html">testDataFrame</a></span><span class="op">(</span><span class="va">x</span>, any.missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cmq</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/qassert.html">qtest</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">cmq</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##    expr    min      lq     mean  median     uq      max neval</span></span>
<span><span class="co">##    r(x) 65.262 66.4385 94.01432 67.0400 68.077 2658.537   100</span></span>
<span><span class="co">##   cm(x) 35.376 35.8620 47.24106 36.7535 37.380  891.182   100</span></span>
<span><span class="co">##  cmq(x) 28.874 29.1395 36.40842 29.4950 29.660  711.596   100</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># checkmate tries to stop as early as possible</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">cmq</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##    expr    min     lq     mean  median     uq     max neval</span></span>
<span><span class="co">##    r(x) 56.385 57.087 58.60676 57.6180 58.504 102.160   100</span></span>
<span><span class="co">##   cm(x)  5.250  5.531  6.52058  6.5120  7.008  25.217   100</span></span>
<span><span class="co">##  cmq(x)  1.132  1.272  1.66579  1.4375  2.029   5.811   100</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-10-2.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="benchmark-5-assert-that-x-is-an-increasing-sequence-of-integers-with-no-missing-values">Benchmark 5: Assert that <code>x</code> is an increasing sequence of
integers with no missing values<a class="anchor" aria-label="anchor" href="#benchmark-5-assert-that-x-is-an-increasing-sequence-of-integers-with-no-missing-values"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="va">x.altrep</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="co"># this is an ALTREP in R version &gt;= 3.5.0</span></span>
<span><span class="va">x.sexp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x.altrep</span><span class="op">)</span>  <span class="co"># this is a regular SEXP OTOH</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">is.integer</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.unsorted.html" class="external-link">is.unsorted</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/checkInteger.html">assertInteger</a></span><span class="op">(</span><span class="va">x</span>, any.missing <span class="op">=</span> <span class="cn">FALSE</span>, sorted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">r</span><span class="op">(</span><span class="va">x.sexp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x.sexp</span><span class="op">)</span>, <span class="fu">r</span><span class="op">(</span><span class="va">x.altrep</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/cm.html" class="external-link">cm</a></span><span class="op">(</span><span class="va">x.altrep</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: microseconds</span></span>
<span><span class="co">##          expr    min      lq     mean median      uq      max neval</span></span>
<span><span class="co">##     r(x.sexp) 29.465 29.8060 66.26618 30.186 63.5990 2628.551   100</span></span>
<span><span class="co">##    cm(x.sexp) 11.401 11.7020 22.89062 11.932 13.1700  905.599   100</span></span>
<span><span class="co">##   r(x.altrep) 38.552 38.9725 49.32543 39.308 71.1225   94.666   100</span></span>
<span><span class="co">##  cm(x.altrep)  3.536  3.9375  5.64839  4.183  4.6890   90.379   100</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">mb</span><span class="op">)</span></span></code></pre></div>
<p><img src="checkmate_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="extending-checkmate">Extending checkmate<a class="anchor" aria-label="anchor" href="#extending-checkmate"></a>
</h2>
<p>To extend checkmate a custom <code>check*</code> function has to be
written. For example, to check for a square matrix one can re-use parts
of checkmate and extend the check with additional functionality:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checkSquareMatrix</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">mode</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># check functions must return TRUE on success</span></span>
<span>  <span class="co"># and a custom error message otherwise</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/checkMatrix.html">checkMatrix</a></span><span class="op">(</span><span class="va">x</span>, mode <span class="op">=</span> <span class="va">mode</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"Must be square"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># a quick test:</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">checkSquareMatrix</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">checkSquareMatrix</span><span class="op">(</span><span class="va">X</span>, mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Must store characters"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">checkSquareMatrix</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Must be square"</span></span></code></pre>
<p>The respective counterparts to the <code>check</code>-function can be
created using the constructors <a href="https://mllg.github.io/checkmate/reference/makeAssertion">makeAssertionFunction</a>,
<a href="https://mllg.github.io/checkmate/reference/makeTest">makeTestFunction</a>
and <a href="https://mllg.github.io/checkmate/reference/makeExpectation">makeExpectationFunction</a>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For assertions:</span></span>
<span><span class="va">assert_square_matrix</span> <span class="op">=</span> <span class="va">assertSquareMatrix</span> <span class="op">=</span> <span class="fu"><a href="../reference/makeAssertion.html">makeAssertionFunction</a></span><span class="op">(</span><span class="va">checkSquareMatrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">assertSquareMatrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (x, mode = NULL, .var.name = checkmate::vname(x), add = NULL) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     if (missing(x)) </span></span>
<span><span class="co">##         stop(sprintf("argument \"%s\" is missing, with no default", </span></span>
<span><span class="co">##             .var.name))</span></span>
<span><span class="co">##     res = checkSquareMatrix(x, mode)</span></span>
<span><span class="co">##     checkmate::makeAssertion(x, res, .var.name, add)</span></span>
<span><span class="co">## }</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For tests:</span></span>
<span><span class="va">test_square_matrix</span> <span class="op">=</span> <span class="va">testSquareMatrix</span> <span class="op">=</span> <span class="fu"><a href="../reference/makeTest.html">makeTestFunction</a></span><span class="op">(</span><span class="va">checkSquareMatrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">testSquareMatrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (x, mode = NULL) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     isTRUE(checkSquareMatrix(x, mode))</span></span>
<span><span class="co">## }</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For expectations:</span></span>
<span><span class="va">expect_square_matrix</span> <span class="op">=</span> <span class="fu"><a href="../reference/makeExpectation.html">makeExpectationFunction</a></span><span class="op">(</span><span class="va">checkSquareMatrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">expect_square_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (x, mode = NULL, info = NULL, label = vname(x)) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     if (missing(x)) </span></span>
<span><span class="co">##         stop(sprintf("Argument '%s' is missing", label))</span></span>
<span><span class="co">##     res = checkSquareMatrix(x, mode)</span></span>
<span><span class="co">##     makeExpectation(x, res, info, label)</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>Note that all the additional arguments <code>.var.name</code>,
<code>add</code>, <code>info</code> and <code>label</code> are
automatically joined with the function arguments of your custom check
function. Also note that if you define these functions inside an R
package, the constructors are called at build-time (thus, there is no
negative impact on the runtime).</p>
</div>
<div class="section level2">
<h2 id="calling-checkmate-from-cc">Calling checkmate from C/C++<a class="anchor" aria-label="anchor" href="#calling-checkmate-from-cc"></a>
</h2>
<p>The package registers two functions which can be used in other
packages’ C/C++ code for argument checks.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>SEXP <span class="fu">qassert</span>(SEXP x, const char <span class="sc">*</span>rule, const char <span class="sc">*</span>name);</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>Rboolean <span class="fu">qtest</span>(SEXP x, const char <span class="sc">*</span>rule);</span></code></pre></div>
<p>These are the counterparts to <a href="https://mllg.github.io/checkmate/reference/qassert">qassert</a>
and <a href="https://mllg.github.io/checkmate/reference/qassert">qtest</a>. Due
to their simplistic interface, they perfectly suit the requirements of
most type checks in C/C++.</p>
<p>For detailed background information on the register mechanism, see
the <a href="https://r-pkgs.org/src.html#c-export" class="external-link">Exporting C Code</a>
section in Hadley’s Book “R Packages” or <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Registering-native-routines" class="external-link">WRE</a>.
Here is a step-by-step guide to get you started:</p>
<ol style="list-style-type: decimal">
<li>Add <code>checkmate</code> to your “Imports” and “LinkingTo”
sections in your DESCRIPTION file.</li>
<li>Create a stub C source file <code>"checkmate_stub.c"</code>, see
below.</li>
<li>Include the provided header file <code>&lt;checkmate.h&gt;</code> in
each compilation unit where you want to use checkmate.</li>
</ol>
<p>File contents for (2):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#include &lt;checkmate.h&gt;</span></span>
<span><span class="co">#include &lt;checkmate_stub.c&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>For the sake of completeness, here the <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> for
the benchmark (but remember the note before on <code>knitr</code>
possibly biasing the results).</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] microbenchmark_1.4.10 ggplot2_3.5.1         checkmate_2.3.2      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.5      jsonlite_1.8.8    highr_0.11        compiler_4.4.1   </span></span>
<span><span class="co">##  [5] jquerylib_0.1.4   systemfonts_1.1.0 scales_1.3.0      textshaping_0.4.0</span></span>
<span><span class="co">##  [9] yaml_2.3.9        fastmap_1.2.0     R6_2.5.1          knitr_1.48       </span></span>
<span><span class="co">## [13] htmlwidgets_1.6.4 backports_1.5.0   tibble_3.2.1      desc_1.4.3       </span></span>
<span><span class="co">## [17] munsell_0.5.1     bslib_0.7.0       pillar_1.9.0      rlang_1.1.4      </span></span>
<span><span class="co">## [21] utf8_1.2.4        cachem_1.1.0      xfun_0.45         fs_1.6.4         </span></span>
<span><span class="co">## [25] sass_0.4.9        cli_3.6.3         pkgdown_2.1.0     withr_3.0.0      </span></span>
<span><span class="co">## [29] magrittr_2.0.3    digest_0.6.36     grid_4.4.1        lifecycle_1.0.4  </span></span>
<span><span class="co">## [33] vctrs_0.6.5       evaluate_0.24.0   glue_1.7.0        farver_2.1.2     </span></span>
<span><span class="co">## [37] ragg_1.3.2        fansi_1.0.6       colorspace_2.1-0  rmarkdown_2.27   </span></span>
<span><span class="co">## [41] tools_4.4.1       pkgconfig_2.0.3   htmltools_0.5.8.1</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michel Lang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
